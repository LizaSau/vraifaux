<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Quizz Vrai ou Faux</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .character {
      max-width: 150px;
      margin-bottom: 10px;
    }

    .speech-bubble {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      max-width: 90%;
      font-size: 18px;
      margin-bottom: 20px;
    }

    .quiz-image {
      max-width: 300px;
      width: 100%;
      margin-bottom: 30px;
    }

    .buttons {
      display: flex;
      gap: 30px;
      margin-top: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      padding: 15px 30px;
      font-size: 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: white;
      min-width: 120px;
    }

    .btn-true {
      background-color: #28a745;
    }

    .btn-false {
      background-color: #dc3545;
    }

    .btn:hover {
      opacity: 0.9;
    }

    #end-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      text-align: center;
      margin-top: 30px;
    }
  </style>
</head>
<body>

  <img src="personnage.png" alt="Formatrice Carrefour" class="character" id="perso">
  <div class="speech-bubble" id="affirmation"></div>
  <img src="" alt="Illustration" class="quiz-image" id="illustration">
  <div class="buttons" id="quiz-buttons">
    <button class="btn btn-true" onclick="repondre(true)">VRAI</button>
    <button class="btn btn-false" onclick="repondre(false)">FAUX</button>
  </div>

  <!-- Écran de fin -->
  <div id="end-screen">
    <img src="personnage.png" alt="Formatrice Carrefour" class="character">
    <div class="speech-bubble" id="final-message"></div>
    <button onclick="window.location.href='index.html'" class="btn" style="margin-top: 20px; background-color: #0078d7;">Retour à l'accueil</button>
  </div>

  <script>
    const quiz = [
      { texte: "L'hôtesse de caisse doit toujours badger en début de poste.", image: "carte.png", reponse: true },
      { texte: "Il est autorisé de prêter son badge à un collègue.", image: "carte.png", reponse: false },
      { texte: "Le fond de caisse doit être vérifié avant l'ouverture.", image: "erreur.png", reponse: true },
      { texte: "On peut encaisser un billet de 500 € sans autorisation.", image: "erreur.png", reponse: false },
      { texte: "Le ticket de caisse est obligatoire pour tout échange ou remboursement.", image: "erreur.png", reponse: true },
      { texte: "Il est interdit de manger en caisse.", image: "hotesse.png", reponse: true },
      { texte: "On peut utiliser son téléphone personnel pendant les encaissements.", image: "hotesse.png", reponse: false },
      { texte: "L'appel d'un responsable est nécessaire pour une erreur de rendu monnaie.", image: "caisse.png", reponse: true },
      { texte: "L'encaissement d'un chèque est autorisé sans pièce d'identité.", image: "caisse.png", reponse: false },
      { texte: "Il faut signaler toute anomalie sur le matériel dès sa découverte.", image: "caisse.png", reponse: true },
      { texte: "Un client peut quitter la ligne de caisse sans payer s’il est pressé.", image: "caisse.png", reponse: false },
      { texte: "Les bons de réduction doivent être scannés avant validation du total.", image: "carte.png", reponse: true },
      { texte: "Les cartes cadeaux sont activées automatiquement à la vente.", image: "hotesse.png", reponse: false },
      { texte: "Le port du badge prénom est obligatoire.", image: "hotesse.png", reponse: true },
      { texte: "Il est autorisé de garder sa caisse ouverte pendant une pause.", image: "caisse.png", reponse: false },
      { texte: "L'hôtesse doit saluer le client à son arrivée.", image: "hotesse.png", reponse: true },
      { texte: "On peut discuter longuement avec un collègue pendant l'encaissement.", image: "erreur.png", reponse: false },
      { texte: "Le rendu monnaie doit toujours être fait au-dessus du tiroir-caisse.", image: "erreur.png", reponse: true },
      { texte: "Les billets suspects doivent être acceptés pour ne pas gêner le client.", image: "erreur.png", reponse: false },
      { texte: "La fin de caisse doit être comptée et signée en fin de poste.", image: "hotesse.png", reponse: true }
    ];

    let index = 0;
    let score = 0;
    let reponsesUtilisateur = [];

    function afficherQuestion() {
      const question = quiz[index];
      document.getElementById("affirmation").textContent = question.texte;
      document.getElementById("illustration").src = question.image || "";
    }

    function repondre(reponseUtilisateur) {
      const bonneReponse = quiz[index].reponse;
      reponsesUtilisateur.push(reponseUtilisateur);
      if (reponseUtilisateur === bonneReponse) score++;
      index++;
      if (index < quiz.length) afficherQuestion();
      else afficherFin();
    }

    function afficherFin() {
      document.getElementById("perso").style.display = "none";
      document.getElementById("affirmation").style.display = "none";
      document.getElementById("illustration").style.display = "none";
      document.getElementById("quiz-buttons").style.display = "none";

      const nom = localStorage.getItem("playerName") || "joueur";
      document.getElementById("final-message").innerHTML =
        `Merci ${nom} de votre participation.<br>Votre score est de ${score} bonnes réponses.`;

      document.getElementById("end-screen").style.display = "flex";

const reponsesFinales = quiz.map((q, i) =>
  q.reponse === reponsesUtilisateur[i] ? "✔️" : "❌"
);

const data = {
  nom: nom,
  score: score,
  reponses: reponsesFinales
};

// Construction du tableau pour NoCodeAPI
const ligne = [data.nom, data.score, ...data.reponses];

fetch("https://v1.nocodeapi.com/lizasau/google_sheets/aJQHIUJBhguVKtbE?tabId=Réponses", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    data: [ligne]
  })
})
.then(res => res.json())
.then(data => {
  console.log("✅ Enregistré via NoCodeAPI :", data);
  document.getElementById("final-message").innerHTML += "<br><small style='color:green;'>✅ Résultat enregistré dans la base.</small>";
})
.catch(err => {
  console.error("❌ Erreur NoCodeAPI :", err);
  document.getElementById("final-message").innerHTML += "<br><small style='color:red;'>⚠️ Enregistrement impossible.</small>";
});


    }

    window.onload = afficherQuestion;
  </script>

</body>
</html>
